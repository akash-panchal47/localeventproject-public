{% extends "base.html" %}
{% load static %}
{% block title %}Today’s Festivals | CityPulse{% endblock %}

{% block content %}

<!-- Page Hero -->
<section class="py-5 text-center bg-dark text-white">
  <div class="container">
    <h1 class="fw-bold text-orange" style="margin-top:30px;">Today’s Festivals</h1>
    <p class="lead">Explore the local festivals happening today!</p>
  </div>
</section>

<!-- Festival Cards -->
<section class="py-5">
  <div class="container">

    <!-- First Row: 4 cards -->
    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4 g-4 mb-5 first-row">
      {% for festival in festivals|slice:":4" %}
        {% if festival.is_active and festival.id %}
        <div class="col d-flex align-items-stretch">
          <div class="card festival-card shadow-sm h-100 border-0 position-relative">

            {% if festival.image %}
              <img src="{{ festival.image.url }}" class="card-img-top festival-img" alt="{{ festival.name }}">
            {% else %}
              <img src="{% static 'app/events/default.jpg' %}" class="card-img-top festival-img" alt="{{ festival.name }}">
            {% endif %}

            <div class="card-body text-center py-3">
              <h6 class="fw-bold mb-1">{{ festival.name }}</h6>
              <p class="small text-muted mb-1">{{ festival.description|truncatewords:10 }}</p>
              <p class="mb-0"><strong>Date:</strong> {{ festival.date|date:"M j, Y" }}</p>
              <p class="mb-0"><strong>Location:</strong> {{ festival.location }}</p>
              {% if festival.organizer %}
                <p class="mb-0"><strong>Organizer:</strong> {{ festival.organizer }}</p>
              {% endif %}

              <!-- Join Event Button -->
              <!-- Join Event Button -->
{% if user.is_authenticated %}
  <a href="{% url 'generate_pass_pdf' festival.id %}" class="btn btn-orange mt-3 w-100">
    <i class="bi bi-ticket-perforated"></i> Join Event
  </a>
{% else %}
  <p class="mt-3 text-muted">Login to join</p>
{% endif %}

            </div>

          </div>
        </div>
        {% endif %}
      {% endfor %}
    </div>

    <!-- Second Row: Remaining cards -->
    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4">
      {% for festival in festivals|slice:"4:" %}
        {% if festival.is_active and festival.id %}
        <div class="col d-flex align-items-stretch">
          <div class="card festival-card shadow-sm h-100 border-0 position-relative">

            {% if festival.image %}
              <img src="{{ festival.image.url }}" class="card-img-top festival-img" alt="{{ festival.name }}">
            {% else %}
              <img src="{% static 'app/events/default.jpg' %}" class="card-img-top festival-img" alt="{{ festival.name }}">
            {% endif %}

            <div class="card-body text-center py-3">
              <h6 class="fw-bold mb-1">{{ festival.name }}</h6>
              <p class="small text-muted mb-1">{{ festival.description|truncatewords:10 }}</p>
              <p class="mb-0"><strong>Date:</strong> {{ festival.date|date:"M j, Y" }}</p>
              <p class="mb-0"><strong>Location:</strong> {{ festival.location }}</p>
              {% if festival.organizer %}
                <p class="mb-0"><strong>Organizer:</strong> {{ festival.organizer }}</p>
              {% endif %}

              <!-- Join Event Button -->
              <!-- Join Event Button -->
{% if user.is_authenticated %}
  <a href="{% url 'generate_pass_pdf' festival.id %}" class="btn btn-orange mt-3 w-100">
    <i class="bi bi-ticket-perforated"></i> Join Event
  </a>
{% else %}
  <p class="mt-3 text-muted">Login to join</p>
{% endif %}

            </div>

          </div>
        </div>
        {% endif %}
      {% endfor %}
    </div>

    {% if festivals|length == 0 %}
      <p class="text-center mt-4">No festivals available today. Add one!</p>
    {% endif %}

  </div>
</section>

{% endblock %}

{% block extra_css %}
<style>
.festival-card {
  border-radius: 12px;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.festival-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 8px 18px rgba(0,0,0,0.2);
}
.festival-img {
  height: 180px;
  object-fit: cover;
  border-top-left-radius: 12px;
  border-top-right-radius: 12px;
}
.first-row {
  margin-bottom: 60px; /* Space between first and second row */
}
.btn-orange {
  background-color: rgba(255, 102, 0, 0.9);
  color: #fff;
  border-radius: 6px;
  transition: background-color 0.3s ease;
}
.btn-orange:hover {
  background-color: rgba(255, 102, 0, 1);
}
</style>
{% endblock %}
